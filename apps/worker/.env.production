# Visage Worker - Production Configuration (ElderTree)
# The worker runs on Mac with GPU, connecting to k8s services

# Worker identity
WORKER_ID=visage-worker-mac

# Device configuration
DEVICE=auto  # auto-detects MPS on Mac

# API connection (k8s ingress)
API_URL=https://visage.eldertree.local

# Redis - use port-forward from k8s
# Run: kubectl port-forward -n visage svc/visage-redis 6379:6379
REDIS_URL=redis://localhost:6379

# MinIO - direct to k8s via ingress
MINIO_ENDPOINT=minio.eldertree.local
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=visage
MINIO_SECURE=true

# Model configuration
MODEL_PRESET=sdxl
VAE_ID=madebyollin/sdxl-vae-fp16-fix

# LoRA training defaults
LORA_RANK=32
LORA_ALPHA=32
LORA_LR=1e-4
LORA_TRAIN_STEPS=1500
LORA_BATCH_SIZE=1

# Generation defaults
NUM_INFERENCE_STEPS=40
GUIDANCE_SCALE=7.5
IMAGE_WIDTH=1024
IMAGE_HEIGHT=1024

# Quality thresholds
MIN_FACE_SIMILARITY=0.7
MIN_QUALITY_SCORE=0.6
MAX_ARTIFACT_SCORE=0.3

# Polling
POLL_INTERVAL=5.0

# Metrics - push to central Pushgateway
PUSHGATEWAY_URL=http://localhost:9091
# Run: kubectl port-forward -n observability svc/pushgateway 9091:9091
METRICS_PUSH_INTERVAL=15.0
